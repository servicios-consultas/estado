<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Consulta de Infracciones | Buenos Aires</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">

  <style>
    body { background-color: #f5f5f5; }
    .infraccion-header { display:flex; align-items:flex-start; }
    .infraccion-header input { margin-top:6px; }
  </style>
</head>

<body>

<!-- HEADER -->
<body>

<!-- NAVBAR SUPERIOR -->
<header>
  <nav class="navbar navbar-expand-lg navbar-light bg-light">
    
    <!-- 游녢 TU BLOQUE VA AC츼 游녢 -->
    <div class="container">
      <a class="navbar-brand" href="https://www.buenosaires.gob.ar/">
        <img class="header-logo" src="https://buenosaires.gob.ar/licenciasdeconducir/consulta-de-infracciones/assets/img/logoBA.svg" alt="Ciudad de buenos aires">
      </a>
      <div class="navbar-search d-responsive ml-auto">
        <form class="form-search form-search-sm">
          <div class="form-group">
            <input type="search" class="form-control form-control-sm input-search" name="header-search" aria-label="Ingrese su b칰squeda" placeholder="Buscar...">
            <button class="reset" type="reset"></button>
          </div>
        </form>
      </div>
      <button class="navbar-toggler collapsed ml-2" data-toggle="collapse" data-target="#navbarSupportedContent">
        Men칰
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="list-group-content d-responsive ml-2">
        <a href="#" aria-label="Cerrar sesi칩n" class="list-group-item list-group-item-logout logout-sm"></a>
      </div>
      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="nav nav-pills">
          <li class="nav-item">
            <a href="https://buenosaires.gob.ar" class="nav-link active"><span>Inicio</span></a>
          </li>
          <li class="nav-item d-responsive">
            <div class="navbar-search">
              <form class="form-search form-search-sm">
                <div class="form-group search-ba">
                  <div class="form-group search-ba">
  <input
    type="search"
    class="form-control form-control-sm input-search"
    name="header-search"
    aria-label="Ingrese su b칰squeda"
    placeholder="Buscar..."
  >
  <button class="btn-search" type="submit" aria-label="Buscar"></button>
                  </div>
</div>
              </form>
            </div>
          </li>
        </ul>
      </div>
    </div>

  </nav>
</header>
<div class="card p-4">
              <h3>Quiero datos sobre</h3>
              <div class="d-flex">
                <div class="custom-control custom-radio" id="radioDom">
                  <input class="custom-control-input" type="radio" name="tipo_consulta" value="Dominio" id="edit-tipo-consulta-dominio">
                  <label class="custom-control-label" for="profession-designer">
                    Una patente
                  </label>
                </div>
                <div class="custom-control custom-radio" id="radioDoc">
                  <input class="custom-control-input" type="radio" name="tipo_consulta" id="edit-tipo-consulta-dni" value="Documento" checked="">
                  <label class="custom-control-label" for="profession-developer">
                    Un documento
                  </label>
                </div>
              </div>
              <div class="d-flex mt-2 flex-wrap " id="panel-documento">
                <div class="form-group col-12 col-lg-4 px-1">
                  <label for="lista-de-seleccion">Tipo de documento*</label>
                  <select class="custom-select" id="edit-tipo-doc" name="tipo_doc">
                    <option>CI</option>
                    <option>CUIT</option>
                    <option selected="">DNI</option>
                    <option>EXT</option>
                    <option>LC</option>
                    <option>LE</option>
                    <option>PAS</option>
                  </select>
                </div>
                <div class="form-group col-12 col-lg-6 px-1">
                  <label for="number-input">N칰mero de documento*</label>
                  <input type="number" class="form-control" id="edit-doc" name="doc" value="">
                </div>
                <small class="col-12">Si tu b칰squeda es por Documento, y tu DNI es menor a
                  10.000.000, utiliz치 las opciones de Libreta de Enrolamiento
                  (LE) o Libreta C칤vica (LC) Consult치 los
                  <a href="https://buenosaires.gob.ar/terminos-y-condiciones-consulta-de-infracciones">t칠rminos y condiciones.</a></small>
              </div>

              <input type="hidden" value="transito" name="filtro_acta">
              <div class="mt-2 flex-wrap d-none" id="panel-dominio">
                <div class="form-group col-12 col-lg-6 px-1">
                  <label for="number-input">Dominio*</label>
                  <input type="text" class="form-control" id="edit-dominio" name="dominio" value="">
                </div>
                <small class="col-12">Al escribir la patente no debe haber espacios.</small>
              </div>

              <div class="infracciones-captcha ml-2 mt-2 mb-2 col-xs-12">
                <fieldset>
                  <div class="g-recaptcha mobileCaptcha" data-sitekey="6LfcRGAlAAAAAJI0S2ABpxX_Wj56oioSE6y393OG"><div style="width: 304px; height: 78px;"><div><iframe title="reCAPTCHA" width="304" height="78" role="presentation" name="a-18lfwwqenaqz" frameborder="0" scrolling="no" sandbox="allow-forms allow-popups allow-same-origin allow-scripts allow-top-navigation allow-modals allow-popups-to-escape-sandbox allow-storage-access-by-user-activation" src="https://www.google.com/recaptcha/api2/anchor?ar=1&amp;k=6LfcRGAlAAAAAJI0S2ABpxX_Wj56oioSE6y393OG&amp;co=aHR0cHM6Ly9idWVub3NhaXJlcy5nb2IuYXI6NDQz&amp;hl=es&amp;v=PoyoqOPhxBO7pBk68S4YbpHZ&amp;size=normal&amp;anchor-ms=20000&amp;execute-ms=30000&amp;cb=4v15kpa398w8"></iframe></div><textarea id="g-recaptcha-response" name="g-recaptcha-response" class="g-recaptcha-response" style="width: 250px; height: 40px; border: 1px solid rgb(193, 193, 193); margin: 10px 25px; padding: 0px; resize: none; display: none;"></textarea></div><iframe style="display: none;"></iframe></div>
                  <script type="text/javascript" src="https://www.google.com/recaptcha/api.js?hl=ES"></script>
                </fieldset>
              </div>
            </div>

<!-- RESULTADOS -->
<div id="resultados" class="d-none">

  <div class="card p-4 mb-4">
    <h3>Datos ingresados</h3>
    <small id="tipoConsulta"></small>
    <h6 id="valorConsulta"></h6>
  </div>

  <h4 id="totalInfracciones"></h4>
  <div id="listaInfracciones"></div>

  <div class="card p-3 mt-3">
    <span id="totalActas">(0 actas seleccionadas)</span>
    <h4 id="totalMonto">$0</h4>
    <span>Puntos a descontar: <strong id="totalPD">0</strong></span><br>
    <span>Puntos a reasignar: <strong id="totalPR">0</strong></span>
  </div>

  <div class="text-right mt-3">
    <button id="btnPagar" class="btn btn-primary btn-lg" disabled>Pagar seleccionadas</button>
  </div>

</div>

</main>

<!-- FOOTER -->
<footer class="bg-light pt-5">
  <div class="container text-center">
    <small>Contenidos licenciados bajo Creative Commons</small>
  </div>
</footer>

<!-- FUNCIONALIDAD -->
<script>
const personasDB = [{
  dni:"30123456",
  dominios:["HFD310","AA123BB"],
  infracciones:[
    { acta:"A01458963", tipo:"Exceso de velocidad", fecha:"15/09/2024", lugar:"Av. Gral Paz", puntosD:5, puntosR:0, monto:25000 }
  ]
}];

let infraccionesActuales=[];

function consultar(){
  const esDominio = radioDominio.checked;
  const dominio = inputDominio.value.toUpperCase().trim();
  const dni = inputDni.value.trim();

  if(esDominio && !dominio) return alert("Ingres치 una patente");
  if(!esDominio && !dni) return alert("Ingres치 un DNI");

  const persona = personasDB.find(p => esDominio ? p.dominios.includes(dominio) : p.dni===dni);
  if(!persona) return alert("No se encontraron infracciones");

  infraccionesActuales = persona.infracciones;
  resultados.classList.remove("d-none");
  tipoConsulta.innerText = esDominio ? "Patente" : "DNI";
  valorConsulta.innerText = esDominio ? dominio : dni;

  render();
}

function render(){
  listaInfracciones.innerHTML="";
  totalInfracciones.innerText = `Infracciones: ${infraccionesActuales.length}`;

  infraccionesActuales.forEach((i,idx)=>{
    listaInfracciones.innerHTML+=`
    <div class="card mb-3">
      <div class="card-header infraccion-header">
        <input type="checkbox" data-i="${idx}" onchange="calcular()">
        <div class="ml-3">
          <strong>${i.acta}</strong><br>${i.tipo}
        </div>
      </div>
      <div class="card-body">
        <p>${i.lugar}</p>
        <h4>$${i.monto.toLocaleString("es-AR")}</h4>
      </div>
    </div>`;
  });
}

function calcular(){
  let total=0,pd=0,pr=0,c=0;
  document.querySelectorAll("#listaInfracciones input").forEach(ch=>{
    if(ch.checked){
      const i=infraccionesActuales[ch.dataset.i];
      total+=i.monto; pd+=i.puntosD; pr+=i.puntosR; c++;
    }
  });
  totalMonto.innerText=`$${total.toLocaleString("es-AR")}`;
  totalPD.innerText=pd;
  totalPR.innerText=pr;
  totalActas.innerText=`(${c} actas seleccionadas)`;
  btnPagar.disabled=c===0;
}

radioDominio.onclick=()=>{panelDominio.classList.remove("d-none");panelDocumento.classList.add("d-none");}
radioDocumento.onclick=()=>{panelDocumento.classList.remove("d-none");panelDominio.classList.add("d-none");}
</script>

<script src="https://www.google.com/recaptcha/api.js?hl=es"></script>
</body>
</html>
