<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Consulta de Infracciones</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet">

<style>
.container-border {
  border: 1px solid #e0e0e0;
  border-radius: 8px;
}
</style>
</head>

<body class="bg-light p-4">

<div class="container">

  <h3 class="mb-3">Consulta de Infracciones</h3>

  <!-- FORMULARIO -->
  <div class="card p-4 mb-4">
    <div class="row g-2">
      <div class="col-md-8">
        <input type="text" id="inputDato" class="form-control"
               placeholder="Ingresá DNI o Patente">
      </div>
      <div class="col-md-4">
        <button class="btn btn-primary w-100" onclick="consultar()">Consultar</button>
      </div>
    </div>
  </div>

  <!-- DATOS INGRESADOS -->
  <div id="datosIngresados" class="container pt-3 pb-2 d-none">
    <div class="row">
      <div class="col-12 col-lg-8">

        <div class="card container-border mb-4 p-4">
          <div class="d-flex align-items-center justify-content-between">
            <h3 class="m-0">Datos ingresados</h3>
            <button class="btn btn-link btn-sm" onclick="location.reload()">
              Nueva consulta
            </button>
          </div>

          <hr class="my-4">

          <small>Opción seleccionada</small>
          <h6 id="tipoConsultaTexto" class="m-0"></h6>

          <hr class="my-4">

          <small id="labelNumero"></small>
          <h6 id="numeroConsultado" class="m-0"></h6>
        </div>

        <div class="card container-border mb-3 p-4">
          <div class="card-body">
            <h4 class="card-title">
              <a href="https://buenosaires.gob.ar/licenciasdeconducir/consulta-de-infracciones/?actas=transito">
                ¿Querés conocer el scoring actual de tu licencia?
              </a>
            </h4>
            <p class="card-text">
              Realizá la búsqueda por documento y conocé cómo impactan
              las infracciones en el puntaje de tu licencia.
            </p>
          </div>
        </div>

      </div>
    </div>
  </div>

  <!-- SIN INFRACCIONES -->
  <div id="sinInfracciones" class="card container-border mb-4 p-4 d-none">
    <div class="d-flex align-items-center justify-content-between">
      <div>
        <h6>No registrás infracciones en este momento.</h6>

        <form action="libreDeuda.php" method="post" target="_blank">
          <input type="hidden" name="libre_deuda" value="1">
          <button class="btn btn-success mt-2" type="submit">
            Descargar libre deuda
          </button>
        </form>
      </div>

      <span class="material-icons-round bg-success text-white rounded-circle p-2">
        check_circle
      </span>
    </div>
  </div>

  <!-- CON INFRACCIONES / ERROR -->
  <div id="conInfracciones" class="alert alert-danger d-none"></div>

</div>

<script>
/* BASE DE DATOS SIMULADA POR PERSONA */
const personas = [
  {
    dni: "12345678",
    dominio: "HDF310",
    sinInfracciones: true
  },
  {
    dni: "87654321",
    dominio: "ABC123",
    sinInfracciones: false
  }
];

function consultar() {
  const input = document.getElementById("inputDato").value.trim().toUpperCase();
  if (!input) return;

  const esDNI = /^\d+$/.test(input);

  const datos = document.getElementById("datosIngresados");
  const tipoConsulta = document.getElementById("tipoConsultaTexto");
  const numero = document.getElementById("numeroConsultado");
  const labelNumero = document.getElementById("labelNumero");

  const sin = document.getElementById("sinInfracciones");
  const con = document.getElementById("conInfracciones");

  // Reset visual
  datos.classList.add("d-none");
  sin.classList.add("d-none");
  con.classList.add("d-none");

  // Buscar persona por DNI O DOMINIO
  const persona = personas.find(p =>
    p.dni === input || p.dominio === input
  );

  if (!persona) {
    con.textContent = "No se encontraron registros para el dato ingresado.";
    con.classList.remove("d-none");
    return;
  }

  // Mostrar datos ingresados
  datos.classList.remove("d-none");

  if (esDNI) {
    tipoConsulta.textContent = "Documento (DNI)";
    labelNumero.textContent = "Número de documento";
    numero.textContent = persona.dni;
  } else {
    tipoConsulta.textContent = "Patente";
    labelNumero.textContent = "Número de patente";
    numero.textContent = persona.dominio;
  }

  // Resultado de infracciones (MISMO para DNI o dominio)
  if (persona.sinInfracciones) {
    sin.classList.remove("d-none");
  } else {
    con.textContent = "Registrás infracciones pendientes.";
    con.classList.remove("d-none");
  }
}
</script>

</body>
</html>
